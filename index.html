<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S.T.D.DENTALLAB - ‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(125deg, #fde2e6 0%, #e3eeff 100%);
            color: #3f3f46;
            overflow-x: hidden;
        }
        .main-card {
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(16px);
            border-radius: 24px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.25);
            position: relative;
            display: flex;
            flex-direction: column;
        }
        .page { display: none; animation: fadeIn 0.6s ease-in-out; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        .floating-element { position: absolute; font-size: 2.5rem; animation: float-up-down 20s infinite ease-in-out; opacity: 0.7; z-index: 0; filter: drop-shadow(0 4px 8px rgba(0,0,0,0.05)); }
        @keyframes float-up-down { 0%, 100% { transform: translateY(-10px); } 50% { transform: translateY(10px); } }
        th { background-color: #a855f7; color: white; }
        tr:nth-child(even) { background-color: #f4f4f5; }
        .text-gradient { background: linear-gradient(45deg, #8b5cf6, #3b82f6, #ec4899); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent; animation: gradient-animation 5s ease infinite; background-size: 200% 200%; }
        @keyframes gradient-animation { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .btn-nav { padding: 0.75rem 1.5rem; border-radius: 9999px; font-weight: 600; color: white; transition: all 0.4s ease; box-shadow: 0 4px 15px -5px rgba(0,0,0,0.2); border: none; background-size: 200% auto; }
        .btn-nav:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 7px 25px -5px rgba(0,0,0,0.3); background-position: right center; }
        .btn-blue { background-image: linear-gradient(to right, #3b82f6 0%, #60a5fa 51%, #3b82f6 100%); }
        .btn-purple { background-image: linear-gradient(to right, #8b5cf6 0%, #a855f7 51%, #8b5cf6 100%); }
        .btn-teal { background-image: linear-gradient(to right, #14b8a6 0%, #2dd4bf 51%, #14b8a6 100%); }
        .btn-pink { background-image: linear-gradient(to right, #ec4899 0%, #f472b6 51%, #ec4899 100%); }
        .accordion-button { width: 100%; background-color: #f3f4f6; color: #374151; text-align: left; padding: 1rem; font-weight: 600; border: none; border-radius: 0.5rem; cursor: pointer; transition: background-color 0.3s ease; display: flex; justify-content: space-between; align-items: center; }
        .accordion-button:hover, .accordion-button.active { background-color: #e5e7eb; }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; background-color: white; padding: 0 1rem; border-top: 1px solid #e5e7eb; }
        .accordion-content.show { max-height: 1000px; padding: 1rem; }
        .accordion-button .icon::after { content: '+'; font-size: 1.5rem; font-weight: 300; transition: transform 0.3s ease; color: #8b5cf6; }
        .accordion-button.active .icon::after { transform: rotate(45deg); }
        .btn-update:hover .update-icon { transform: rotate(180deg); }
        .update-icon { transition: transform 0.5s ease; display: inline-block; }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    
    <iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

    <div class="main-card w-full max-w-5xl mx-auto p-6 sm:p-10 z-10 overflow-hidden">
        <div id="cover-emojis-container" class="absolute top-0 left-0 w-full h-full pointer-events-none"></div>

        <div class="absolute bottom-4 right-4 sm:bottom-6 sm:right-6 transform transition-all duration-300 hover:scale-110 hover:rotate-6 z-20">
             <div class="bg-white p-2 rounded-full shadow-lg">
                <img src="https://img2.pic.in.th/pic/327187868_5984159441670866_6296357359655082698_n.jpg" 
                     alt="Logo" class="h-16 w-16 sm:h-20 sm:w-20 rounded-full object-cover"
                     onerror="this.onerror=null; this.src='https://placehold.co/80x80/e0c3fc/333?text=Logo';">
            </div>
        </div>
        
        <main class="flex-grow flex flex-col">
            <section id="page-cover" class="page active flex-grow flex flex-col">
                <div class="flex-grow flex flex-col items-center justify-center text-center">
                    <h1 class="text-gradient text-5xl sm:text-7xl font-extrabold tracking-tight">S.T.D. DENTALLAB</h1>
                    <p class="text-xl sm:text-2xl font-medium text-zinc-600 mt-4">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤ ‚ú®</p>
                    <div class="flex flex-wrap justify-center gap-4 mt-12">
                        <button onclick="showPage('page-register')" class="btn-nav btn-blue">üìù ‡∏™‡∏ô‡πÉ‡∏à‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</button>
                        <button onclick="showPage('page-dashboard')" class="btn-nav btn-purple">üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
                        <button onclick="showPage('page-benefits')" class="btn-nav btn-teal">üåü ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</button>
                        <button onclick="showPage('page-catalog')" class="btn-nav btn-pink">üñºÔ∏è Catalog ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button>
                    </div>
                </div>
                <footer class="mt-8 pt-6 border-t border-gray-200 text-center text-xs sm:text-sm text-gray-600">
                     <p><b>‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤:</b> ‡∏´‡πâ‡∏≤‡∏á‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡πÄ‡∏≠‡∏™.‡∏ó‡∏µ.‡∏î‡∏µ.‡πÄ‡∏î‡πá‡∏ô‡∏ï‡∏≠‡∏• ‡πÅ‡∏•‡∏õ ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà<br>
                        ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏•‡∏õ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏ô‡∏¥‡∏Å‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏•‡∏∞‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏ó‡∏±‡πà‡∏ß‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®<br>
                        ‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏±‡∏ô</p>
                     <p class="mt-2"><b>‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏≥‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô:</b> ‡∏ï.‡∏™‡∏±‡∏ô‡∏õ‡∏π‡πÄ‡∏•‡∏¢ ‡∏≠.‡∏î‡∏≠‡∏¢‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà (‡πÉ‡∏Å‡∏•‡πâ‡πÅ‡∏¢‡∏Å‡πÅ‡∏°‡πà‡∏Å‡∏ß‡∏á)</p>
                </footer>
            </section>

            <section id="page-dashboard" class="page">
                <div class="grid grid-cols-3 items-center mb-6">
                    <div class="text-left"><button onclick="showPage('page-cover')" class="px-5 py-2 rounded-full font-semibold text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 hover:scale-105 hover:shadow-md transition-all shadow-sm flex items-center gap-2">üè†<span class="hidden sm:inline"> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></button></div>
                    <div class="text-center"><h2 class="text-xl sm:text-2xl font-bold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£ (30 ‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å)</h2></div>
                    <div class="text-right"><button id="update-dashboard" class="btn-update px-3 sm:px-4 py-2 rounded-full bg-sky-500 text-white hover:bg-sky-600 transition-all transform hover:scale-105 shadow-md flex items-center gap-2 text-sm font-semibold ml-auto"><span class="update-icon">üîÑ</span><span class="hidden sm:inline">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span></button></div>
                </div>
                <div class="mb-4 text-center" id="filter-buttons"></div>
                <div class="overflow-x-auto"><table class="w-full text-sm sm:text-base bg-white shadow-md rounded-lg"><thead><tr><th class="p-3">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th><th class="p-3">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th><th class="p-3">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</th></tr></thead><tbody id="dashboard-table-body"></tbody></table></div>
            </section>

            <section id="page-register" class="page">
                 <div class="grid grid-cols-3 items-center mb-6">
                    <div class="text-left"><button onclick="showPage('page-cover')" class="px-5 py-2 rounded-full font-semibold text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 hover:scale-105 hover:shadow-md transition-all shadow-sm flex items-center gap-2">üè†<span class="hidden sm:inline"> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></button></div>
                    <div class="text-center"><h2 class="text-xl sm:text-2xl font-bold">‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô</h2></div>
                    <div></div>
                </div>
                <form id="application-form" class="space-y-4" method="POST" target="hidden_iframe">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <input type="text" id="fullName" name="fullName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•" class="w-full p-3 rounded-md border" required>
                        <select id="gender" name="gender" class="w-full p-3 rounded-md border" required><option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏® --</option><option value="‡∏ä‡∏≤‡∏¢">‡∏ä‡∏≤‡∏¢</option><option value="‡∏´‡∏ç‡∏¥‡∏á">‡∏´‡∏ç‡∏¥‡∏á</option><option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option></select>
                        <input type="tel" id="phone" name="phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö" class="w-full p-3 rounded-md border" required>
                        <select id="district" name="district" class="w-full p-3 rounded-md border" required></select>
                        <input type="number" id="age" name="age" placeholder="‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)" class="w-full p-3 rounded-md border" required>
                        <input type="number" id="weight" name="weight" placeholder="‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å‡∏Å.)" class="w-full p-3 rounded-md border" required>
                        <input type="number" id="height" name="height" placeholder="‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã‡∏°.)" class="w-full p-3 rounded-md border" required>
                        <input type="text" id="health" name="health" placeholder="‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏¢‡∏ï‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" class="w-full p-3 rounded-md border">
                        <input type="text" id="education" name="education" placeholder="‡∏ß‡∏∏‡∏í‡∏¥‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤" class="w-full p-3 rounded-md border" required>
                        <select id="position" name="position" class="w-full p-3 rounded-md border" required><option value="">-- ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á --</option><option value="‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î">‡∏ä‡πà‡∏≤‡∏á‡∏ó‡∏±‡∏ô‡∏ï‡∏Å‡∏£‡∏£‡∏°‡∏ù‡∏∂‡∏Å‡∏´‡∏±‡∏î</option><option value="‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏ò‡∏∏‡∏£‡∏Å‡∏≤‡∏£</option><option value="‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</option></select>
                    </div>
                    <button type="submit" class="w-full p-4 font-semibold rounded-lg text-white bg-pink-500 hover:bg-pink-600 transition-colors">‡∏™‡πà‡∏á‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
                </form>
            </section>
            
            <section id="page-catalog" class="page">
                 <div class="grid grid-cols-3 items-center mb-6">
                    <div class="text-left"><button onclick="showPage('page-cover')" class="px-5 py-2 rounded-full font-semibold text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 hover:scale-105 hover:shadow-md transition-all shadow-sm flex items-center gap-2">üè†<span class="hidden sm:inline"> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></button></div>
                    <div class="text-center"><h2 class="text-xl sm:text-2xl font-bold">Catalog ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2></div>
                    <div class="text-right"><button id="update-catalog" class="btn-update px-3 sm:px-4 py-2 rounded-full bg-sky-500 text-white hover:bg-sky-600 transition-all transform hover:scale-105 shadow-md flex items-center gap-2 text-sm font-semibold ml-auto"><span class="update-icon">üîÑ</span><span class="hidden sm:inline">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span></button></div>
                </div>
                <div id="catalog-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6"></div>
            </section>
            
            <section id="page-benefits" class="page">
                 <div class="grid grid-cols-3 items-center mb-6">
                    <div class="text-left"><button onclick="showPage('page-cover')" class="px-5 py-2 rounded-full font-semibold text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 hover:scale-105 hover:shadow-md transition-all shadow-sm flex items-center gap-2">üè†<span class="hidden sm:inline"> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span></button></div>
                    <div class="text-center"><h2 class="text-xl sm:text-2xl font-bold">‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£</h2></div>
                    <div class="text-right"><button id="update-benefits" class="btn-update px-3 sm:px-4 py-2 rounded-full bg-sky-500 text-white hover:bg-sky-600 transition-all transform hover:scale-105 shadow-md flex items-center gap-2 text-sm font-semibold ml-auto"><span class="update-icon">üîÑ</span><span class="hidden sm:inline">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span></button></div>
                </div>
                <div id="benefits-accordion" class="space-y-4"><p class="text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p></div>
            </section>
        </main>
    </div>

    <script>
        const GAS_URL = 'https://script.google.com/macros/s/AKfycbz9ut83XDGMex7ZiLhdkSqzgy4__Lul2DswbLpv1yP0bkJ62MManR5WcSw7SONQd1bC/exec';
        let fullDashboardData = [];
        let submitted = false; 

        document.addEventListener('DOMContentLoaded', () => {
            initChiangMaiDistricts();
            createFloatingEmojis();
            document.getElementById('application-form').action = GAS_URL;
            showPage('page-cover'); 

            const iframe = document.getElementById('hidden_iframe');
            iframe.addEventListener('load', function () {
                if (submitted) {
                    handleSuccess();
                }
            });

            document.getElementById('application-form').addEventListener('submit', handleFormSubmit);
            document.getElementById('update-dashboard').addEventListener('click', () => renderDashboard(true));
            document.getElementById('update-catalog').addEventListener('click', () => renderCatalog(true));
            document.getElementById('update-benefits').addEventListener('click', () => renderBenefits(true));
        });
        
        function handleSuccess() {
            if (!submitted) return; 
            submitted = false; 
            Swal.fire({
                icon: 'success',
                title: '‡∏™‡πà‡∏á‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                text: '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤ ‡∏ó‡∏≤‡∏á‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡πá‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î'
            });
            document.getElementById('application-form').reset();
            initChiangMaiDistricts();
            renderDashboard(true); 
        }
        
        function handleFormSubmit(e) {
            const form = e.target;
            if (!form.checkValidity()) {
                form.reportValidity();
                e.preventDefault();
                return;
            }
            submitted = true;
            Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...', text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà', allowOutsideClick: false, didOpen: () => Swal.showLoading() });
        }
        
        function createFloatingEmojis() {
            const container = document.getElementById('cover-emojis-container');
            const emojis = ['ü¶∑', '‚ú®', 'üíñ', 'üöÄ', 'üåü', 'ÔøΩ', 'üì¶', 'üéâ', 'üìÑ', 'üí°'];
            const emojiCount = 15;
            for (let i = 0; i < emojiCount; i++) {
                const emojiEl = document.createElement('div');
                emojiEl.classList.add('floating-element');
                emojiEl.innerText = emojis[i % emojis.length];
                emojiEl.style.left = `${Math.random() * 100}%`;
                emojiEl.style.top = `${Math.random() * 100}%`;
                emojiEl.style.fontSize = `${Math.random() * 1.5 + 1.5}rem`;
                emojiEl.style.animationDuration = `${Math.random() * 15 + 10}s`;
                emojiEl.style.animationDelay = `${Math.random() * 10}s`;
                container.appendChild(emojiEl);
            }
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            const isCover = pageId === 'page-cover';
            document.getElementById('cover-emojis-container').style.display = isCover ? 'block' : 'none';
            if (pageId === 'page-dashboard' && fullDashboardData.length === 0) renderDashboard();
            if (pageId === 'page-catalog' && document.getElementById('catalog-grid').innerHTML === "") renderCatalog();
            if (pageId === 'page-benefits' && document.getElementById('benefits-accordion').innerHTML.includes('...')) renderBenefits();
        }
        
        function fetchData(sheetName, forceUpdate = false) {
            const cacheKey = `data_${sheetName}`;
            const cachedData = localStorage.getItem(cacheKey);
            if (cachedData && !forceUpdate) return Promise.resolve(JSON.parse(cachedData));
            const timestamp = new Date().getTime();
            const url = `${GAS_URL}?sheet=${sheetName}&callback=jsonpCallback&_=${timestamp}`;
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = url;
                window.jsonpCallback = (data) => {
                    if (data.status === 'error') reject(new Error(data.message));
                    else { localStorage.setItem(cacheKey, JSON.stringify(data)); resolve(data); }
                    document.body.removeChild(script);
                    delete window.jsonpCallback;
                };
                script.onerror = () => {
                    reject(new Error('Failed to load script for JSONP request.'));
                    document.body.removeChild(script);
                    delete window.jsonpCallback;
                };
                document.body.appendChild(script);
            });
        }
        
        // --- UPDATED DASHBOARD RENDERING LOGIC ---
        async function renderDashboard(forceUpdate = false) {
            const tableBody = document.getElementById('dashboard-table-body');
            tableBody.innerHTML = '<tr><td colspan="3" class="text-center p-8">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>';
            try {
                const data = await fetchData('Dashboard', forceUpdate);
                // DO NOT REVERSE the array to get the first entries
                fullDashboardData = data.slice(); 
                // Initially display the first 30 applicants
                displayDashboardData(fullDashboardData.slice(0, 30)); 
                setupFilterButtons();
            } catch (error) {
                tableBody.innerHTML = `<tr><td colspan="3" class="text-center p-8 text-red-500">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}</td></tr>`;
            }
        }

        function displayDashboardData(data) {
             if (!data || data.length === 0) { document.getElementById('dashboard-table-body').innerHTML = '<tr><td colspan="3" class="text-center p-8">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</td></tr>'; return; }
            document.getElementById('dashboard-table-body').innerHTML = data.map(row => `<tr class="hover:bg-gray-100"><td class="p-3">${row['‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•'] || ''}</td><td class="p-3">${row['‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á'] || ''}</td><td class="p-3">${row['‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£'] || ''}</td></tr>`).join('');
        }

        function setupFilterButtons() {
            const filterContainer = document.getElementById('filter-buttons');
            const positions = ['‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î', ...new Set(fullDashboardData.map(row => row['‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á']).filter(p => p))];
            filterContainer.innerHTML = positions.map(pos => `<button class="px-3 py-1 m-1 rounded-full text-sm transition-colors duration-300 ${pos === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î' ? 'bg-purple-600 text-white' : 'bg-gray-200 hover:bg-purple-200'}" data-position="${pos}">${pos}</button>`).join('');
            filterContainer.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    filterContainer.querySelectorAll('button').forEach(b => { b.classList.remove('bg-purple-600', 'text-white'); b.classList.add('bg-gray-200'); });
                    btn.classList.add('bg-purple-600', 'text-white');
                    btn.classList.remove('bg-gray-200');
                    
                    const position = e.target.dataset.position;
                    const filteredData = (position === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î') 
                        ? fullDashboardData 
                        : fullDashboardData.filter(row => row['‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á'] === position);
                    
                    displayDashboardData(filteredData.slice(0, 30));
                });
            });
        }
        
        function initChiangMaiDistricts() {
            const districts = ["‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà", "‡∏™‡∏≤‡∏£‡∏†‡∏µ", "‡∏™‡∏±‡∏ô‡∏Å‡∏≥‡πÅ‡∏û‡∏á", "‡∏™‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏¢", "‡∏î‡∏≠‡∏¢‡∏™‡∏∞‡πÄ‡∏Å‡πá‡∏î", "‡πÅ‡∏°‡πà‡∏£‡∏¥‡∏°", "‡πÅ‡∏°‡πà‡πÅ‡∏ï‡∏á", "‡πÅ‡∏°‡πà‡∏≠‡∏≠‡∏ô", "‡∏´‡∏≤‡∏á‡∏î‡∏á", "‡∏™‡∏±‡∏ô‡∏õ‡πà‡∏≤‡∏ï‡∏≠‡∏á", "‡∏à‡∏≠‡∏°‡∏ó‡∏≠‡∏á", "‡∏î‡∏≠‡∏¢‡∏´‡∏•‡πà‡∏≠", "‡πÄ‡∏ß‡∏µ‡∏¢‡∏á‡∏´‡∏ô‡∏≠‡∏á‡∏•‡πà‡∏≠‡∏á", "‡∏ö‡πâ‡∏≤‡∏ô‡πÇ‡∏Æ‡πà‡∏á", "‡πÅ‡∏°‡πà‡∏ß‡∏≤‡∏á", "‡∏™‡∏∞‡πÄ‡∏°‡∏¥‡∏á", "‡∏Å‡∏±‡∏•‡∏¢‡∏≤‡∏ì‡∏¥‡∏ß‡∏±‡∏í‡∏ô‡∏≤", "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡∏î‡∏≤‡∏ß", "‡∏û‡∏£‡πâ‡∏≤‡∏ß", "‡πÄ‡∏ß‡∏µ‡∏¢‡∏á‡πÅ‡∏´‡∏á", "‡πÑ‡∏ä‡∏¢‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£", "‡∏ù‡∏≤‡∏á", "‡πÅ‡∏°‡πà‡∏≠‡∏≤‡∏¢", "‡πÅ‡∏°‡πà‡πÅ‡∏à‡πà‡∏°", "‡∏Æ‡∏≠‡∏î", "‡∏î‡∏≠‡∏¢‡πÄ‡∏ï‡πà‡∏≤", "‡∏≠‡∏°‡∏Å‡πã‡∏≠‡∏¢"];
            document.getElementById('district').innerHTML = '<option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô --</option>' + districts.map(d => `<option value="${d}">${d}</option>`).join('');
        }
        
        async function renderCatalog(forceUpdate = false) {
            const grid = document.getElementById('catalog-grid');
            grid.innerHTML = '<p class="col-span-full text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>';
            try {
                const data = await fetchData('catalog', forceUpdate);
                 if (!data || !data.length) { grid.innerHTML = '<p class="col-span-full text-center">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</p>'; return; }
                grid.innerHTML = data.map(item => `
                    <div class="group relative aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-200 cursor-pointer shadow-lg" onclick="window.open('${item.ImageURL}', '_blank')">
                        <img src="${item.ImageURL}" alt="${item.ProductName}" class="h-full w-full object-cover object-center transition-transform duration-300 group-hover:scale-110" onerror="this.onerror=null; this.src='https://placehold.co/400x400/e0c3fc/333?text=Image+Not+Found';">
                        <div class="absolute top-0 left-0 right-0 p-3 bg-gradient-to-b from-black/60 to-transparent transition-all duration-300">
                            <h3 class="text-white text-center font-bold text-lg drop-shadow-md">${item.ProductName || 'Untitled'}</h3>
                        </div>
                    </div>`).join('');
            } catch (error) { grid.innerHTML = `<p class="col-span-full text-center text-red-500">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}</p>`; }
        }
        
        async function renderBenefits(forceUpdate = false) {
            const accordionContainer = document.getElementById('benefits-accordion');
            accordionContainer.innerHTML = '<p class="text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>';
            try {
                const data = await fetchData('benefit', forceUpdate);
                const categories = [ "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏à‡∏∏‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó", "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô", "‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô" ];
                const groupedData = categories.reduce((acc, category) => { acc[category] = data.filter(item => item.Category === category).map(item => item.Detail); return acc; }, {});
                if (data.length === 0) { accordionContainer.innerHTML = '<p class="text-center">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡∏Å‡∏≤‡∏£</p>'; return; }
                accordionContainer.innerHTML = categories.map((category) => {
                    const details = groupedData[category];
                    if (!details || details.length === 0) return ''; 
                    return `<div class="border rounded-lg overflow-hidden shadow-sm bg-white"><button class="accordion-button"><span>${category}</span><span class="icon"></span></button><div class="accordion-content"><ul class="list-disc list-inside space-y-2 text-zinc-600 pt-2">${details.map(detail => `<li>${detail}</li>`).join('')}</ul></div></div>`;
                }).join('');
                accordionContainer.querySelectorAll('.accordion-button').forEach(button => {
                    button.addEventListener('click', () => {
                        const wasActive = button.classList.contains('active');
                        accordionContainer.querySelectorAll('.accordion-button').forEach(btn => { btn.classList.remove('active'); btn.nextElementSibling.classList.remove('show'); });
                        if (!wasActive) { button.classList.add('active'); button.nextElementSibling.classList.add('show'); }
                    });
                });
            } catch(error) { accordionContainer.innerHTML = `<p class="text-red-500 text-center">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}</p>`; }
        }
    </script>
</body>
</html>
ÔøΩ
